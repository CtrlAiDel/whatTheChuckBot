"use strict";Object.defineProperty(exports,"__esModule",{value:!0});const __1=require("../../.."),Subcommand_1=require("../../../class/Subcommand");async function interactionPostUpdate(e,t){e.args;const n=e.interaction;e.client;var a=e.ephemerality,s=t.length,r="Post IS UPDATED HERES THE RESULTS !!!!!!!!\n",e=await n.followUp({content:r,ephemeral:a}),e=await n.channel.messages.fetch(e.id);const o=await n.channel.messages.fetch(e.id);let c,l=!1;for(const i of t){try{c={content:r+`Deleted: 0/${s} delay = 2sec/msg. ðŸ˜‰:white_check_mark: `}}catch(e){c={content:r+`Deleted: 0/${s} delay = 2sec/msg. ðŸ¤”:x:`},l=!0}await o.edit(c)}l?n.followUp({content:"Deletion is finnished !!!!!!!!",ephemeral:a}):n.followUp({content:"Deletion is finnished !!!!!!!! \n Some errors occured in the proccess ðŸ¤”:x:",ephemeral:a})}async function mesgDeleterInterval(t,n){if(n<=0||n>=Number.MAX_SAFE_INTEGER){const e=new Error;throw e.message=`[${e.stack}]
Argument msInterval is out of range => number[0-maxSafeInt]`,e}return new Promise(async e=>{setTimeout(async()=>{e(await t.delete())},n)})}exports.default=new Subcommand_1.SubCommand(async l=>{const i=l.interaction;var e=await __1.commandHelper.resolveEphemerality(i,"private");await i.deferReply({ephemeral:e});const m=l.args;l.client;const h=new Subcommand_1.FollowUpObj;try{let t,n=0,a=0,e,s=0;const u=m.getUser("author",!0).username,d=m.getChannel("channel",!0);let r=await d.messages.fetch(),o=r.lastKey();let c=[];for(;0<r.size;)s===r.size&&(r=await d.messages.fetch({before:o}),o=r.lastKey(),s=0),r.forEach(e=>{t=e.author.username,s++,n++,a+=t===u?1:0,e.deletable&&t===u&&(e.createdTimestamp,c.push(e))});d.bulkDelete(c),e=c.length,0<a&&0<e?(h.reply={content:`I'm done! I'll be deleting: ${e}/${n}. ðŸ˜‰:white_check_mark: `},i.client.emit("debug",`CHANNEL ${d.name} IS BEING PURGED BY ${i.member.user.username} => channelID: ${d.id} numDelted: `+e)):0===n?h.reply={content:"I was unable to find any messages in this channel?! ðŸ¤” :white_check_mark: "}:0===a?h.reply={content:"No message found from this author! ðŸ¤”:white_check_mark: "}:0===e&&0<a?h.reply={content:`I was unable to delete any of the ${a} messages! ðŸ¤”:x:
Maybe check the permissions I have on your server???`}:e!==a&&(h.reply={content:`I was unable to delete ${a-e} of the messages! ðŸ¤”:x:`},i.client.emit("debug",`CHANNEL ${d.name} IS BEING PURGED BY ${i.member.user.username} => channelID: ${d.id} numDelted: `+e)),await i.editReply(h.reply),await interactionPostUpdate(l,c)}catch(e){return h.fromatOnError(e),void await i.followUp(h.reply)}});